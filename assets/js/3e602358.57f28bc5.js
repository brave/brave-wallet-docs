"use strict";(self.webpackChunkbrave_wallet_docs=self.webpackChunkbrave_wallet_docs||[]).push([[199],{6577:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"ethereum/rpc-api/methods","title":"Methods","description":"eth_sendTransaction","source":"@site/docs/ethereum/rpc-api/methods.md","sourceDirName":"ethereum/rpc-api","slug":"/ethereum/rpc-api/methods","permalink":"/ethereum/rpc-api/methods","draft":false,"unlisted":false,"editUrl":"https://github.com/brave/brave-wallet-docs/edit/main/docs/ethereum/rpc-api/methods.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/ethereum/rpc-api/overview"},"next":{"title":"Overview","permalink":"/solana"}}');var r=n(4848),c=n(8453);const i={sidebar_position:2},a="Methods",d={},h=[{value:"<code>eth_sendTransaction</code>",id:"eth_sendtransaction",level:2},{value:"<code>eth_signTransaction</code>",id:"eth_signtransaction",level:2},{value:"<code>eth_sendRawTransaction</code>",id:"eth_sendrawtransaction",level:2},{value:"<code>eth_subscribe</code>",id:"eth_subscribe",level:2},{value:"<code>eth_unsubscribe</code>",id:"eth_unsubscribe",level:2},{value:"<code>wallet_addEthereumChain</code>",id:"wallet_addethereumchain",level:2},{value:"<code>wallet_switchEthereumChain</code>",id:"wallet_switchethereumchain",level:2},{value:"<code>wallet_watchAsset</code>",id:"wallet_watchasset",level:2},{value:"<code>eth_getEncryptionPublicKey</code> (deprecated)",id:"eth_getencryptionpublickey-deprecated",level:2},{value:"Example:",id:"example",level:3},{value:"Setup a new wallet:",id:"setup-a-new-wallet",level:4},{value:"Get the public key:",id:"get-the-public-key",level:4},{value:"Run these commands in a test directory:\u2028",id:"run-these-commands-in-a-test-directory",level:4},{value:"In UI:",id:"in-ui",level:4},{value:"Issuing the decrypt command",id:"issuing-the-decrypt-command",level:4},{value:"<code>eth_decrypt</code> (deprecated)",id:"eth_decrypt-deprecated",level:2}];function o(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"methods",children:"Methods"})}),"\n",(0,r.jsx)(t.h2,{id:"eth_sendtransaction",children:(0,r.jsx)(t.code,{children:"eth_sendTransaction"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_sendtransaction",children:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_sendtransaction"})}),"\n",(0,r.jsx)(t.h2,{id:"eth_signtransaction",children:(0,r.jsx)(t.code,{children:"eth_signTransaction"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_signtransaction",children:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_signtransaction"})}),"\n",(0,r.jsx)(t.h2,{id:"eth_sendrawtransaction",children:(0,r.jsx)(t.code,{children:"eth_sendRawTransaction"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_sendrawtransaction",children:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_sendrawtransaction"})}),"\n",(0,r.jsx)(t.h2,{id:"eth_subscribe",children:(0,r.jsx)(t.code,{children:"eth_subscribe"})}),"\n",(0,r.jsxs)(t.p,{children:["Allows for a new subscription to be created. When a subscription is created, ",(0,r.jsx)(t.code,{children:"message"})," events will be fired with new block information."]}),"\n",(0,r.jsxs)(t.p,{children:["Unlike the ",(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/tutorials/using-websockets/#eth-subscribe",children:"documentation here"}),", you can use ",(0,r.jsx)(t.code,{children:"eth_subscribe"})," even with an HTTPS RPC URLs configured in Brave Wallet.\nOnly ",(0,r.jsx)(t.code,{children:"newHeads"})," is currently supported."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/tutorials/using-websockets/#eth-subscribe",children:"https://ethereum.org/en/developers/tutorials/using-websockets/#eth-subscribe"})}),"\n",(0,r.jsx)(t.h2,{id:"eth_unsubscribe",children:(0,r.jsx)(t.code,{children:"eth_unsubscribe"})}),"\n",(0,r.jsxs)(t.p,{children:["Allows for a previous subscription to be removed.\n",(0,r.jsx)(t.code,{children:"message"})," events will stop being fired after a subscription is unsubscribed."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/tutorials/using-websockets/#eth-unsubscribe",children:"https://ethereum.org/en/developers/tutorials/using-websockets/#eth-unsubscribe"})}),"\n",(0,r.jsx)(t.h2,{id:"wallet_addethereumchain",children:(0,r.jsx)(t.code,{children:"wallet_addEthereumChain"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"wallet_addEthereumChain"})," accepts a single object parameter, specified by the following TypeScript interface:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"interface AddEthereumChainParameter {\n  chainId: string;\n  blockExplorerUrls?: string[];\n  chainName?: string;\n  iconUrls?: string[];\n  nativeCurrency?: {\n    name: string;\n    symbol: string;\n    decimals: number;\n  };\n  rpcUrls?: string[];\n}\n"})}),"\n",(0,r.jsx)(t.h2,{id:"wallet_switchethereumchain",children:(0,r.jsx)(t.code,{children:"wallet_switchEthereumChain"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"wallet_switchEthereumChain"})," accepts a single object parameter, specified by the following TypeScript interface:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"interface SwitchEthereumChainParameter {\n  chainId: string;\n}\n"})}),"\n",(0,r.jsx)(t.h2,{id:"wallet_watchasset",children:(0,r.jsx)(t.code,{children:"wallet_watchAsset"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"wallet_watchAsset"})," accepts a single object parameter, specified by the following TypeScript interface:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"interface WatchAssetParameters {\n  type: string; // The asset's interface, e.g. 'ERC20'\n  options: {\n    address: string; // The hexadecimal Ethereum address of the token contract\n    symbol?: string; // A ticker symbol or shorthand, up to 5 alphanumerical characters\n    decimals?: number; // The number of asset decimals\n    image?: string; // A string url of the token logo\n  };\n}\n"})}),"\n",(0,r.jsxs)(t.h2,{id:"eth_getencryptionpublickey-deprecated",children:[(0,r.jsx)(t.code,{children:"eth_getEncryptionPublicKey"})," (deprecated)"]}),"\n",(0,r.jsx)(t.p,{children:"Requests that the user shares their public encryption key. Returns a Promise that resolve to the public encryption key, or rejects if the user denied the request."}),"\n",(0,r.jsx)(t.p,{children:"The public key is computed from entropy associated with the specified user account, using the nacl (opens new window)implementation of the X25519_XSalsa20_Poly1305 algorithm."}),"\n",(0,r.jsx)(t.h3,{id:"example",children:"Example:"}),"\n",(0,r.jsx)(t.h4,{id:"setup-a-new-wallet",children:"Setup a new wallet:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"Seed:\nhome various adjust motion canvas stand combine gravity cluster behave despair dove\n\nPrivate key:\n72d388592fb23300948c9eaf2dfaa60b8c3297903f2ea698d489d7c12116e2e6\n\nAddress is: \n0xB884707865B85990e6a140a12C3e5f5D24FE5736\n"})}),"\n",(0,r.jsx)(t.h4,{id:"get-the-public-key",children:"Get the public key:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"var x= await window.ethereum.request({method:'eth_getEncryptionPublicKey', params:['0xB884707865B85990e6a140a12C3e5f5D24FE5736']})\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Check the value of ",(0,r.jsx)(t.code,{children:"x"}),":"]}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:["\u2028",(0,r.jsx)(t.code,{children:"'eui9/fqCHT7aSUkKK9eooQFnOCD9COK9Mi1ZtOxIj2A='"})]}),"\n"]}),"\n",(0,r.jsx)(t.h4,{id:"run-these-commands-in-a-test-directory",children:"Run these commands in a test directory:\u2028"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"npm install @metamask/eth-sig-util\nnpm install ethereumjs-util\n\nAnd then run this script:\u2028\n```js\nconst ethUtil = require('ethereumjs-util');\nconst sigUtil  = require('@metamask/eth-sig-util');\n\nconst encryptedMessage = ethUtil.bufferToHex(\n  Buffer.from(\n    JSON.stringify(\n      sigUtil.encrypt({\n        publicKey: 'eui9/fqCHT7aSUkKK9eooQFnOCD9COK9Mi1ZtOxIj2A=',\n        data: 'Ode to Anthony!',\n        version: 'x25519-xsalsa20-poly1305',\n      })\n    ),\n    'utf8'\n  )\n);\n"})}),"\n",(0,r.jsx)(t.h4,{id:"in-ui",children:"In UI:"}),"\n",(0,r.jsxs)(t.p,{children:["If you then check the value of ",(0,r.jsx)(t.code,{children:"encryptedMessage"})," you'll see:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"'0x7b2276657273696f6e223a227832353531392d7873616c736132302d706f6c7931333035222c226e6f6e6365223a2232666f7254336e4350425279653944654d31515375574e385776475a5670584e222c22657068656d5075626c69634b6579223a226d6a67655235324a4347446c393333367551774e3239716b62595230574c4b4367696e42504446747958593d222c2263697068657274657874223a22653378704b703276476d70643965634f6a524a36786c7456723046656f2b506d2f432f67544d437944673d3d227d'\n"})}),"\n",(0,r.jsx)(t.p,{children:"You can get back at the string with:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"JSON.parse(Buffer.from('7b2276657273696f6e223a227832353531392d7873616c736132302d706f6c7931333035222c226e6f6e6365223a2232666f7254336e4350425279653944654d31515375574e385776475a5670584e222c22657068656d5075626c69634b6579223a226d6a67655235324a4347446c393333367551774e3239716b62595230574c4b4367696e42504446747958593d222c2263697068657274657874223a22653378704b703276476d70643965634f6a524a36786c7456723046656f2b506d2f432f67544d437944673d3d227d', 'hex'))\n"})}),"\n",(0,r.jsx)(t.p,{children:"Which gives:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"{\n  version: 'x25519-xsalsa20-poly1305',\n  nonce: '2forT3nCPBRye9DeM1QSuWN8WvGZVpXN',\n  ephemPublicKey: 'mjgeR52JCGDl9336uQwN29qkbYR0WLKCginBPDFtyXY=',\n  ciphertext: 'e3xpKp2vGmpd9ecOjRJ6xltVr0Feo+Pm/C/gTMCyDg=='\n}\n"})}),"\n",(0,r.jsx)(t.h4,{id:"issuing-the-decrypt-command",children:"Issuing the decrypt command"}),"\n",(0,r.jsx)(t.p,{children:"Finally run the decrypt command with your encrypted string:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"const encryptedMessage = '0x7b2276657273696f6e223a227832353531392d7873616c736132302d706f6c7931333035222c226e6f6e6365223a2232666f7254336e4350425279653944654d31515375574e385776475a5670584e222c22657068656d5075626c69634b6579223a226d6a67655235324a4347446c393333367551774e3239716b62595230574c4b4367696e42504446747958593d222c2263697068657274657874223a22653378704b703276476d70643965634f6a524a36786c7456723046656f2b506d2f432f67544d437944673d3d227d'\nethereum\n  .request({\n    method: 'eth_decrypt',\n    params: [encryptedMessage, '0xB884707865B85990e6a140a12C3e5f5D24FE5736']\n  })\n  .then((decryptedMessage) =>\n    console.log('The decrypted message is:', decryptedMessage)\n  )\n  .catch((error) => console.log(error.message));\n"})}),"\n",(0,r.jsx)(t.p,{children:"It will popup the UI to decrypt the message for the user. And if you press approve it will send it back to the Dapp. Check the JS console in dev tools to see."}),"\n",(0,r.jsxs)(t.h2,{id:"eth_decrypt-deprecated",children:[(0,r.jsx)(t.code,{children:"eth_decrypt"})," (deprecated)"]}),"\n",(0,r.jsx)(t.p,{children:"This method requests that Brave Wallet decrypts the given encrypted message."}),"\n",(0,r.jsx)(t.p,{children:"Parameters:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"A serialized JSON object which is base64 encoded and contains amongst other things the encrypted message and the seed"}),"\n",(0,r.jsx)(t.li,{children:"The ethereum account that can decrypt the message as the second."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"If the user doesn't approve, then the operation results in an error (user rejected).\nThe user can peak at the data at any time to see what the encrypted blob contains before decrypting it to the dapp.\nThe decrypted message is only returned to the Dapp if the decrypt request is approved.\nSince this is not trusted content, when decrypting the message, Brave will sanitize first, then parse the JSON object."}),"\n",(0,r.jsxs)(t.p,{children:["The message must have been encrypted using the public encryption key of the given Ethereum address.  See also ",(0,r.jsx)(t.code,{children:"eth_getEncryptionPublicKey"}),".\nThis method returns a Promise that resolves to the decrypted message, or rejects if the decryption attempt fails."]})]})}function l(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var s=n(6540);const r={},c=s.createContext(r);function i(e){const t=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(c.Provider,{value:t},e.children)}}}]);